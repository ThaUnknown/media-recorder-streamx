(function(E,p){typeof exports=="object"&&typeof module<"u"?module.exports=p():typeof define=="function"&&define.amd?define(p):(E=typeof globalThis<"u"?globalThis:E||self,E.MediaRecorderStream=p())})(this,function(){"use strict";var E={exports:{}},p=typeof Reflect=="object"?Reflect:null,ee=p&&typeof p.apply=="function"?p.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},P;p&&typeof p.ownKeys=="function"?P=p.ownKeys:Object.getOwnPropertySymbols?P=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:P=function(e){return Object.getOwnPropertyNames(e)};function Me(i){console&&console.warn&&console.warn(i)}var te=Number.isNaN||function(e){return e!==e};function o(){o.init.call(this)}E.exports=o,E.exports.once=ke,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var ie=10;function M(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return ie},set:function(i){if(typeof i!="number"||i<0||te(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");ie=i}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||te(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ne(i){return i._maxListeners===void 0?o.defaultMaxListeners:i._maxListeners}o.prototype.getMaxListeners=function(){return ne(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r=e==="error",a=this._events;if(a!==void 0)r=r&&a.error===void 0;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var f=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw f.context=s,f}var c=a[e];if(c===void 0)return!1;if(typeof c=="function")ee(c,this,t);else for(var u=c.length,h=oe(c,u),n=0;n<u;++n)ee(h[n],this,t);return!0};function re(i,e,t,n){var r,a,s;if(M(t),a=i._events,a===void 0?(a=i._events=Object.create(null),i._eventsCount=0):(a.newListener!==void 0&&(i.emit("newListener",e,t.listener?t.listener:t),a=i._events),s=a[e]),s===void 0)s=a[e]=t,++i._eventsCount;else if(typeof s=="function"?s=a[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),r=ne(i),r>0&&s.length>r&&!s.warned){s.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=i,f.type=e,f.count=s.length,Me(f)}return i}o.prototype.addListener=function(e,t){return re(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return re(this,e,t,!0)};function We(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function se(i,e,t){var n={fired:!1,wrapFn:void 0,target:i,type:e,listener:t},r=We.bind(n);return r.listener=t,n.wrapFn=r,r}o.prototype.once=function(e,t){return M(t),this.on(e,se(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return M(t),this.prependListener(e,se(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,a,s,f;if(M(t),r=this._events,r===void 0)return this;if(n=r[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(a=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){f=n[s].listener,a=s;break}if(a<0)return this;a===0?n.shift():Ce(n,a),n.length===1&&(r[e]=n[0]),r.removeListener!==void 0&&this.emit("removeListener",e,f||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),s;for(r=0;r<a.length;++r)s=a[r],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this};function ae(i,e,t){var n=i._events;if(n===void 0)return[];var r=n[e];return r===void 0?[]:typeof r=="function"?t?[r.listener||r]:[r]:t?Ue(r):oe(r,r.length)}o.prototype.listeners=function(e){return ae(this,e,!0)},o.prototype.rawListeners=function(e){return ae(this,e,!1)},o.listenerCount=function(i,e){return typeof i.listenerCount=="function"?i.listenerCount(e):ue.call(i,e)},o.prototype.listenerCount=ue;function ue(i){var e=this._events;if(e!==void 0){var t=e[i];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?P(this._events):[]};function oe(i,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=i[n];return t}function Ce(i,e){for(;e+1<i.length;e++)i[e]=i[e+1];i.pop()}function Ue(i){for(var e=new Array(i.length),t=0;t<e.length;++t)e[t]=i[t].listener||i[t];return e}function ke(i,e){return new Promise(function(t,n){function r(s){i.removeListener(e,a),n(s)}function a(){typeof i.removeListener=="function"&&i.removeListener("error",r),t([].slice.call(arguments))}le(i,e,a,{once:!0}),e!=="error"&&Fe(i,r,{once:!0})})}function Fe(i,e,t){typeof i.on=="function"&&le(i,"error",e,t)}function le(i,e,t,n){if(typeof i.on=="function")n.once?i.once(e,t):i.on(e,t);else if(typeof i.addEventListener=="function")i.addEventListener(e,function r(a){n.once&&i.removeEventListener(e,r),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof i)}var Ye=typeof queueMicrotask=="function"?queueMicrotask:i=>Promise.resolve().then(i),je=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}};const fe=je;var qe=class{constructor(e){this.hwm=e||16,this.head=new fe(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){const t=this.head;this.head=t.next=new fe(2*this.head.buffer.length),this.head.push(e)}}shift(){const e=this.tail.shift();if(e===void 0&&this.tail.next){const t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}};const{EventEmitter:Ge}=E.exports,G=new Error("Stream was destroyed"),K=new Error("Premature close"),he=Ye,de=qe,l=(1<<25)-1,x=1,T=2,g=4,_e=l^x,v=1<<3,W=2<<3,C=4<<3,m=8<<3,w=16<<3,U=32<<3,y=64<<3,V=128<<3,B=256<<3,H=512<<3,d=1024<<3,k=2049<<3,F=4096<<3,Ke=l^v,Ve=l^W,Be=l^(W|F),He=l^C,Qe=l^F,Xe=l^w,ze=l^(m|H),$e=l^y,ce=l^(w|U),Je=l^k,b=1<<16,Q=2<<16,X=4<<16,R=8<<16,L=16<<16,A=32<<16,z=64<<16,Y=129<<16,N=256<<16,pe=l^b,Ze=l^X,Se=l^Q,et=l^N,tt=l^L,it=l^R,nt=l^Y,I=v|b,me=l^I,$=d|A,S=T|g,_=S|x,be=S|$,rt=Se&Ve,Ee=(Y|k)&me,xe=I|Ee,Te=_|Ee,st=_|y|d,ve=_|d|m,at=w|U,ut=v|C,ot=v|C|F,lt=W|v,ft=_|y|m,ht=B|m,dt=_|B|m|H,_t=_|v|y|d|F,ct=S|y|d,pt=_|N|A,St=R|L,ye=R|b,mt=R|L|_|b,Re=_|b|R,bt=Q|b,Et=b|X,xt=_|N|ye|A,Tt=L|S|N|A,j=Symbol.asyncIterator||Symbol("asyncIterator");class Ae{constructor(e,{highWaterMark:t=16384,map:n=null,mapWritable:r,byteLength:a,byteLengthWritable:s}={}){this.stream=e,this.queue=new de,this.highWaterMark=t,this.buffered=0,this.error=null,this.pipeline=null,this.byteLength=s||a||Oe,this.map=r||n,this.afterWrite=Nt.bind(this),this.afterUpdateNextTick=gt.bind(this)}get ended(){return(this.stream._duplexState&A)!==0}push(e){return this.map!==null&&(e=this.map(e)),this.buffered+=this.byteLength(e),this.queue.push(e),this.buffered<this.highWaterMark?(this.stream._duplexState|=R,!0):(this.stream._duplexState|=St,!1)}shift(){const e=this.queue.shift(),t=this.stream;return this.buffered-=this.byteLength(e),this.buffered===0&&(t._duplexState&=it),e}end(e){typeof e=="function"?this.stream.once("finish",e):e!=null&&this.push(e),this.stream._duplexState=(this.stream._duplexState|N)&Se}autoBatch(e,t){const n=[],r=this.stream;for(n.push(e);(r._duplexState&Re)===ye;)n.push(r._writableState.shift());if((r._duplexState&_)!==0)return t(null);r._writev(n,t)}update(){const e=this.stream;for(;(e._duplexState&Re)===R;){const t=this.shift();e._duplexState|=Et,e._write(t,this.afterWrite),e._duplexState&=Ze}(e._duplexState&bt)===0&&this.updateNonPrimary()}updateNonPrimary(){const e=this.stream;if((e._duplexState&xt)===N){e._duplexState=(e._duplexState|b)&et,e._final(wt.bind(this));return}if((e._duplexState&S)===T){(e._duplexState&xe)===0&&(e._duplexState|=I,e._destroy(we.bind(this)));return}(e._duplexState&Te)===x&&(e._duplexState=(e._duplexState|I)&_e,e._open(Ne.bind(this)))}updateNextTick(){(this.stream._duplexState&Y)===0&&(this.stream._duplexState|=Y,he(this.afterUpdateNextTick))}}class vt{constructor(e,{highWaterMark:t=16384,map:n=null,mapReadable:r,byteLength:a,byteLengthReadable:s}={}){this.stream=e,this.queue=new de,this.highWaterMark=t,this.buffered=0,this.error=null,this.pipeline=null,this.byteLength=s||a||Oe,this.map=r||n,this.pipeTo=null,this.afterRead=It.bind(this),this.afterUpdateNextTick=Dt.bind(this)}get ended(){return(this.stream._duplexState&d)!==0}pipe(e,t){if(this.pipeTo!==null)throw new Error("Can only pipe to one destination");if(typeof t!="function"&&(t=null),this.stream._duplexState|=U,this.pipeTo=e,this.pipeline=new Rt(this.stream,e,t),t&&this.stream.on("error",Pe),q(e))e._writableState.pipeline=this.pipeline,t&&e.on("error",Pe),e.on("finish",this.pipeline.finished.bind(this.pipeline));else{const n=this.pipeline.done.bind(this.pipeline,e),r=this.pipeline.done.bind(this.pipeline,e,null);e.on("error",n),e.on("close",r),e.on("finish",this.pipeline.finished.bind(this.pipeline))}e.on("drain",At.bind(this)),this.stream.emit("piping",e),e.emit("pipe",this.stream)}push(e){const t=this.stream;return e===null?(this.highWaterMark=0,t._duplexState=(t._duplexState|y)&Be,!1):(this.map!==null&&(e=this.map(e)),this.buffered+=this.byteLength(e),this.queue.push(e),t._duplexState=(t._duplexState|m)&Qe,this.buffered<this.highWaterMark)}shift(){const e=this.queue.shift();return this.buffered-=this.byteLength(e),this.buffered===0&&(this.stream._duplexState&=ze),e}unshift(e){let t;const n=[];for(;(t=this.queue.shift())!==void 0;)n.push(t);this.push(e);for(let r=0;r<n.length;r++)this.queue.push(n[r])}read(){const e=this.stream;if((e._duplexState&ve)===m){const t=this.shift();return this.pipeTo!==null&&this.pipeTo.write(t)===!1&&(e._duplexState&=ce),(e._duplexState&V)!==0&&e.emit("data",t),t}return null}drain(){const e=this.stream;for(;(e._duplexState&ve)===m&&(e._duplexState&at)!==0;){const t=this.shift();this.pipeTo!==null&&this.pipeTo.write(t)===!1&&(e._duplexState&=ce),(e._duplexState&V)!==0&&e.emit("data",t)}}update(){const e=this.stream;for(this.drain();this.buffered<this.highWaterMark&&(e._duplexState&_t)===0;)e._duplexState|=ot,e._read(this.afterRead),e._duplexState&=He,(e._duplexState&v)===0&&this.drain();(e._duplexState&dt)===ht&&(e._duplexState|=H,e.emit("readable")),(e._duplexState&lt)===0&&this.updateNonPrimary()}updateNonPrimary(){const e=this.stream;if((e._duplexState&ft)===y&&(e._duplexState=(e._duplexState|d)&$e,e.emit("end"),(e._duplexState&be)===$&&(e._duplexState|=T),this.pipeTo!==null&&this.pipeTo.end()),(e._duplexState&S)===T){(e._duplexState&xe)===0&&(e._duplexState|=I,e._destroy(we.bind(this)));return}(e._duplexState&Te)===x&&(e._duplexState=(e._duplexState|I)&_e,e._open(Ne.bind(this)))}updateNextTick(){(this.stream._duplexState&k)===0&&(this.stream._duplexState|=k,he(this.afterUpdateNextTick))}}class yt{constructor(e){this.data=null,this.afterTransform=Lt.bind(e),this.afterFinal=null}}class Rt{constructor(e,t,n){this.from=e,this.to=t,this.afterPipe=n,this.error=null,this.pipeToFinished=!1}finished(){this.pipeToFinished=!0}done(e,t){if(t&&(this.error=t),e===this.to&&(this.to=null,this.from!==null)){((this.from._duplexState&d)===0||!this.pipeToFinished)&&this.from.destroy(this.error||new Error("Writable stream closed prematurely"));return}if(e===this.from&&(this.from=null,this.to!==null)){(e._duplexState&d)===0&&this.to.destroy(this.error||new Error("Readable stream closed before ending"));return}this.afterPipe!==null&&this.afterPipe(this.error),this.to=this.from=this.afterPipe=null}}function At(){this.stream._duplexState|=U,(this.stream._duplexState&ut)===0?this.updateNextTick():this.drain()}function wt(i){const e=this.stream;i&&e.destroy(i),(e._duplexState&S)===0&&(e._duplexState|=A,e.emit("finish")),(e._duplexState&be)===$&&(e._duplexState|=T),e._duplexState&=pe,this.update()}function we(i){const e=this.stream;!i&&this.error!==G&&(i=this.error),i&&e.emit("error",i),e._duplexState|=g,e.emit("close");const t=e._readableState,n=e._writableState;t!==null&&t.pipeline!==null&&t.pipeline.done(e,i),n!==null&&n.pipeline!==null&&n.pipeline.done(e,i)}function Nt(i){const e=this.stream;i&&e.destroy(i),e._duplexState&=pe,(e._duplexState&mt)===L&&(e._duplexState&=tt,(e._duplexState&z)===z&&e.emit("drain")),(e._duplexState&X)===0&&this.update()}function It(i){i&&this.stream.destroy(i),this.stream._duplexState&=Ke,(this.stream._duplexState&C)===0&&this.update()}function Dt(){this.stream._duplexState&=Je,this.update()}function gt(){this.stream._duplexState&=nt,this.update()}function Ne(i){const e=this.stream;i&&e.destroy(i),(e._duplexState&T)===0&&((e._duplexState&st)===0&&(e._duplexState|=W),(e._duplexState&pt)===0&&(e._duplexState|=Q),e.emit("open")),e._duplexState&=me,e._writableState!==null&&e._writableState.update(),e._readableState!==null&&e._readableState.update()}function Lt(i,e){e!=null&&this.push(e),this._writableState.afterWrite(i)}class J extends Ge{constructor(e){super(),this._duplexState=0,this._readableState=null,this._writableState=null,e&&(e.open&&(this._open=e.open),e.destroy&&(this._destroy=e.destroy),e.predestroy&&(this._predestroy=e.predestroy),e.signal&&e.signal.addEventListener("abort",kt.bind(this)))}_open(e){e(null)}_destroy(e){e(null)}_predestroy(){}get readable(){return this._readableState!==null?!0:void 0}get writable(){return this._writableState!==null?!0:void 0}get destroyed(){return(this._duplexState&g)!==0}get destroying(){return(this._duplexState&S)!==0}destroy(e){(this._duplexState&S)===0&&(e||(e=G),this._duplexState=(this._duplexState|T)&rt,this._readableState!==null&&(this._readableState.error=e,this._readableState.updateNextTick()),this._writableState!==null&&(this._writableState.error=e,this._writableState.updateNextTick()),this._predestroy())}on(e,t){return this._readableState!==null&&(e==="data"&&(this._duplexState|=V|w,this._readableState.updateNextTick()),e==="readable"&&(this._duplexState|=B,this._readableState.updateNextTick())),this._writableState!==null&&e==="drain"&&(this._duplexState|=z,this._writableState.updateNextTick()),super.on(e,t)}}class O extends J{constructor(e){super(e),this._duplexState|=x|A,this._readableState=new vt(this,e),e&&(e.read&&(this._read=e.read),e.eagerOpen&&this.resume().pause())}_read(e){e(null)}pipe(e,t){return this._readableState.pipe(e,t),this._readableState.updateNextTick(),e}read(){return this._readableState.updateNextTick(),this._readableState.read()}push(e){return this._readableState.updateNextTick(),this._readableState.push(e)}unshift(e){return this._readableState.updateNextTick(),this._readableState.unshift(e)}resume(){return this._duplexState|=w,this._readableState.updateNextTick(),this}pause(){return this._duplexState&=Xe,this}static _fromAsyncIterator(e,t){let n;const r=new O({...t,read(s){e.next().then(a).then(s.bind(null,null)).catch(s)},predestroy(){n=e.return()},destroy(s){if(!n)return s(null);n.then(s.bind(null,null)).catch(s)}});return r;function a(s){s.done?r.push(null):r.push(s.value)}}static from(e,t){if(Ct(e))return e;if(e[j])return this._fromAsyncIterator(e[j](),t);Array.isArray(e)||(e=e===void 0?[]:[e]);let n=0;return new O({...t,read(r){this.push(n===e.length?null:e[n++]),r(null)}})}static isBackpressured(e){return(e._duplexState&ct)!==0||e._readableState.buffered>=e._readableState.highWaterMark}static isPaused(e){return(e._duplexState&w)===0}[j](){const e=this;let t=null,n=null,r=null;return this.on("error",u=>{t=u}),this.on("readable",a),this.on("close",s),{[j](){return this},next(){return new Promise(function(u,h){n=u,r=h;const D=e.read();D!==null?f(D):(e._duplexState&g)!==0&&f(null)})},return(){return c(null)},throw(u){return c(u)}};function a(){n!==null&&f(e.read())}function s(){n!==null&&f(null)}function f(u){r!==null&&(t?r(t):u===null&&(e._duplexState&d)===0?r(G):n({value:u,done:u===null}),r=n=null)}function c(u){return e.destroy(u),new Promise((h,D)=>{if(e._duplexState&g)return h({value:void 0,done:!0});e.once("close",function(){u?D(u):h({value:void 0,done:!0})})})}}}class Ot extends J{constructor(e){super(e),this._duplexState|=x|d,this._writableState=new Ae(this,e),e&&(e.writev&&(this._writev=e.writev),e.write&&(this._write=e.write),e.final&&(this._final=e.final))}_writev(e,t){t(null)}_write(e,t){this._writableState.autoBatch(e,t)}_final(e){e(null)}static isBackpressured(e){return(e._duplexState&Tt)!==0}write(e){return this._writableState.updateNextTick(),this._writableState.push(e)}end(e){return this._writableState.updateNextTick(),this._writableState.end(e),this}}class Ie extends O{constructor(e){super(e),this._duplexState=x,this._writableState=new Ae(this,e),e&&(e.writev&&(this._writev=e.writev),e.write&&(this._write=e.write),e.final&&(this._final=e.final))}_writev(e,t){t(null)}_write(e,t){this._writableState.autoBatch(e,t)}_final(e){e(null)}write(e){return this._writableState.updateNextTick(),this._writableState.push(e)}end(e){return this._writableState.updateNextTick(),this._writableState.end(e),this}}class De extends Ie{constructor(e){super(e),this._transformState=new yt(this),e&&(e.transform&&(this._transform=e.transform),e.flush&&(this._flush=e.flush))}_write(e,t){this._readableState.buffered>=this._readableState.highWaterMark?this._transformState.data=e:this._transform(e,this._transformState.afterTransform)}_read(e){if(this._transformState.data!==null){const t=this._transformState.data;this._transformState.data=null,e(null),this._transform(t,this._transformState.afterTransform)}else e(null)}_transform(e,t){t(null,e)}_flush(e){e(null)}_final(e){this._transformState.afterFinal=e,this._flush(Mt.bind(this))}}class Pt extends De{}function Mt(i,e){const t=this._transformState.afterFinal;if(i)return t(i);e!=null&&this.push(e),this.push(null),t(null)}function Wt(...i){return new Promise((e,t)=>ge(...i,n=>{if(n)return t(n);e()}))}function ge(i,...e){const t=Array.isArray(i)?[...i,...e]:[i,...e],n=t.length&&typeof t[t.length-1]=="function"?t.pop():null;if(t.length<2)throw new Error("Pipeline requires at least 2 streams");let r=t[0],a=null,s=null;for(let u=1;u<t.length;u++)a=t[u],q(r)?r.pipe(a,c):(f(r,!0,u>1,c),r.pipe(a)),r=a;if(n){let u=!1;a.on("finish",()=>{u=!0}),a.on("error",h=>{s=s||h}),a.on("close",()=>n(s||(u?null:K)))}return a;function f(u,h,D,Z){u.on("error",Z),u.on("close",jt);function jt(){if(h&&u._readableState&&!u._readableState.ended||D&&u._writableState&&!u._writableState.ended)return Z(K)}}function c(u){if(!(!u||s)){s=u;for(const h of t)h.destroy(u)}}}function Le(i){return!!i._readableState||!!i._writableState}function q(i){return typeof i._duplexState=="number"&&Le(i)}function Ct(i){return q(i)&&i.readable}function Ut(i){return typeof i=="object"&&i!==null&&typeof i.byteLength=="number"}function Oe(i){return Ut(i)?i.byteLength:1024}function Pe(){}function kt(){this.destroy(new Error("Stream aborted."))}var Ft={pipeline:ge,pipelinePromise:Wt,isStream:Le,isStreamx:q,Stream:J,Writable:Ot,Readable:O,Duplex:Ie,Transform:De,PassThrough:Pt};class Yt extends Ft.Readable{constructor(e,t){super(t),this._recorder=new MediaRecorder(e,t),this._recorder.addEventListener("dataavailable",this._handleData.bind(this))}pause(){this.destroyed||(this._recorder.pause(),super.pause())}resume(){this.destroyed||(this._recorder.resume(),super.resume())}start(e){this.destroyed||this._recorder.start(e)}stop(){this.destroyed||this._recorder.stop()}_handleData({data:e}){this.destroyed||(e.size>0&&this.push(e),this._recorder||this.push(null))}_cleanup(){var e,t;(e=this._recorder)==null||e.stop(),(t=this._recorder)==null||t.removeEventListener("dataavailable",this._handleData),this._recorder=null}destroy(){this._cleanup()}_predestroy(){this._cleanup()}static isTypeSupported(...e){return MediaRecorder.isTypeSupported(...e)}}return Yt});
